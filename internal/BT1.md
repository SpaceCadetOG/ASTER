Backtesting the Momentum-Fibonacci Trading Strategy

Strategy Overview and Multi-Timeframe Setup

This strategy combines momentum filtering, trend confirmation, Fibonacci retracement levels, and strict risk management. It is applied on multiple timeframes in tandem: 15-minute for trend & momentum bias, 5-minute for structure and retracement planning, and 1-minute for precise entry/exit triggers. The strategy works on both long and short trades by symmetrically applying the logic to uptrends and downtrends. In backtesting, we will simulate each step of the strategy’s decision flow to evaluate performance over historical data. Key principles include only trading strong momentum assets (based on 24h % change, volume, and funding conditions), entering on pullbacks into Fibonacci zones with confirmation, maintaining at least a 1:1 initial risk-to-reward (preferably 2:1 or higher), and actively managing the trade with partial profit-taking and trailing stops.

1. Pre-Filter Candidates (Momentum Scanner Criteria)

Begin by filtering the universe of coins for high-momentum, liquid candidates. A trade is considered only if all of the following conditions are met (otherwise skip the asset for that day/session):
	•	24h Price Change (Δ24h) – ≥ +25% and ≤ +90%. This ensures significant volatility/momentum is present, but avoids coins that are extremely overextended or “exhausted” from a >90% spike in one day.
	•	24h Volume – ≥ $10 million traded. High volume suggests ample liquidity and reduces the risk of illiquid “wick” spikes. Thinly traded coins can produce unreliable price action and large slippage, so they are filtered out to avoid illiquid moves that can’t be managed reliably.
	•	Funding Rate (for perpetual futures) – ≤ 0.25% (positive funding). A very high positive funding rate indicates overcrowded long positions (everyone is long and paying high fees), which often precedes pullbacks ￼ ￼. By requiring funding ≤ 0.25%, we avoid chasing longs when bullish sentiment is euphorically high. (For shorts, you could analogously avoid highly negative funding beyond -0.25% to skip crowded shorts.)
	•	Momentum Score – ≥ 70 (on a 0–100 scale). If using a custom momentum scoring indicator, ensure it indicates strong upward momentum (e.g. price strength and volume flow). This confirms the trend’s strength. If no explicit score is available, you can substitute requirements like price above key moving averages on higher timeframes or a high RSI, etc., to gauge momentum.
	•	Bid/Ask Spread – Tight (negligible). The order book spread should be minimal relative to price (especially for lower timeframe entries) to ensure reliable fills. Wide spreads suggest poor liquidity. In backtesting, you might model a slippage or skip trades on assets with consistently wide spreads.

By applying these pre-filters, your backtest will focus only on high-quality trade candidates (strong trend, high volume, not overly crowded). This mirrors a live scanner that alerts you only to favorable setups. It’s better to have no trade than a sub-par trade in low-liquidity or low-momentum conditions.

2. Trend Bias Confirmation (15-Minute Chart)

For each candidate passing the scanner, determine the trend bias on the 15-minute timeframe (you can also check 1-hour for additional context, but 15m is typically granular enough for intra-day bias):
	•	Bullish Bias (Long Trades): Require the 9-period EMA to be above the 20-period EMA, and the current price is trading above the VWAP on the 15m chart. This alignment indicates a clear short-term uptrend and that price is sustained above the volume-weighted average price (sign of buying interest). When price stays above VWAP, it confirms bullish sentiment and trend strength ￼. The 9 EMA crossing over the 20 EMA further confirms upward momentum in the recent price data. Only consider long entries when these conditions hold. If 9EMA drops below 20EMA or price falls under VWAP, any long setup is invalidated (trend bias no longer bullish).
	•	Bearish Bias (Short Trades): Conversely, for short trades, require 9 EMA < 20 EMA and price below VWAP on 15m – indicating a downtrend with bearish momentum. Only consider short entries under those conditions (if price is above VWAP or EMAs bullishly crossed, skip short attempts as the trend is not clearly down).

This step ensures you trade in the direction of the prevailing trend on a medium intraday timeframe. In backtesting, you would iterate through each 15m candle and only proceed to look for setups when the trend bias criteria are met (flagging potential trade entry windows). Trades against the 15m trend are avoided, which increases win probability by aligning with momentum. For example, if the 15m 9 EMA crossed above the 20 EMA two hours ago and price is holding above VWAP, the bias is long – you will then watch for a bullish pullback entry. If those conditions flip, you abort any planned long trade.

3. Identify the Active Swing and Fibonacci Levels (5-Minute Chart)

Once bias is established, zoom into the 5-minute chart to identify the current price swing that will anchor our Fibonacci retracement plan:
	•	Determine the Swing High and Low: Find the most recent significant impulsive move in the direction of the trend. In an uptrend (long bias), identify the latest swing low to swing high that price has made on the 5m chart. In a downtrend (short bias), identify the latest swing high down to swing low. This “active swing” is the price leg we expect to retrace partially before the trend possibly continues. It helps to look for a clear run-up (for longs) or drop (for shorts) that has recently peaked and started a pullback. Mark the Swing High (peak) and Swing Low (trough) of that move. These points will be 100% and 0% for Fibonacci calculations.
	•	Draw Fibonacci Retracement Levels: Calculate the key Fib retracement levels for this swing: 38.2% (0.382), 50% (0.500), 61.8% (0.618) of the swing’s height. Also note the 100% level (which is the origin of the move, same as swing low for uptrend or swing high for downtrend) and common extension levels beyond the swing, like 127.2% (1.272) and 161.8% (1.618). These will be potential profit target levels if the trend resumes upward beyond the previous high. Many charting tools compute these automatically once you mark the swing endpoints.

Now you have a “map” of potential support (for longs) or resistance (for shorts) zones based on Fibonacci ratios. Empirically, pullbacks in strong trends often stall around the 50%–61.8% retracement zone ￼ ￼ – this is sometimes called the “golden pocket” around the 61.8% level. In our strategy, this is the preferred buy zone for longs (and sell zone for shorts), as it offers a balance between a meaningful dip and not retracing too deep to indicate a trend reversal.

Example: The daily chart above shows Home Depot (HD) retracing roughly 50% of a prior uptrend move, with Fibonacci levels acting as support zones. Notice how the pullback (red decline) pauses around the 38.2%–61.8% levels, which are marked as “Retracement Levels (alert zones)”. Traders would watch for a bullish reversal in this area. Fibonacci retracement levels serve as alerts for a potential reversal, not guarantees – additional confirmation (candlestick patterns, oscillators, moving average support, etc.) is used to validate the entry ￼. Our backtesting will likewise treat the 50–61.8% retracement band as a key buy zone, but only enter if price shows signs of resuming the uptrend there.

Note: In some cases, the 38.2% retracement might already attract buyers in an extremely strong trend (shallow pullback). But our plan prioritizes the deeper 50–61.8% zone unless momentum is so strong that a shallow retracement (38%) is all we get – you might miss a few shallow pullbacks, but this filter avoids premature entries. Conversely, if the pullback exceeds the 61.8% significantly, it may be a deep retracement (or potential trend change), which triggers caution or alternative handling (discussed later in management).

4. Plan Entry, Stop-Loss, and Targets with Fib Confluence

Using the Fibonacci levels and the chart structure, formulate a detailed trade plan:
	•	Entry Zone: The ideal **entry is in the 0.50–0.618 retracement zone of the identified swing. In backtesting, you can simulate an entry once price dips into this range. Rather than picking a single price, treat it as a zone – for example, if swing low to high spans $100 to $120, the 50–61.8% zone is roughly $110–$106. (One approach is to plan a limit order at the midpoint or 61.8% level, or even scale in within the zone.) This zone often overlaps with technical support: look for confluence such as a prior demand zone (former resistance turned support, or a consolidation area) or an EMA cluster (e.g. the 50 EMA or 200 EMA on 5m may coincide there). Such overlap adds confidence that buyers will step in. If you don’t see any support factors around the Fib zone (say price sliced straight up earlier with no structure), the trade is riskier.
	•	Stop-Loss Placement: Set the stop-loss just below the 0.618 level (for longs) or just above 0.618 (for shorts), with a small buffer of ~0.5%–1%. The idea is to place the stop slightly beyond the retracement zone, below the swing’s origin, so that if price drops past that, the pattern of higher lows is broken. You can also use the actual swing low of the move (structure low) as the stop, plus a buffer. For example, if going long and 61.8% Fib is $105 and swing low was $100, you might put the stop at $99 (a bit under the swing low). The buffer ensures random wicks don’t stop you out if price briefly probes liquidity below support ￼. Important: This stop should represent a reasonable risk (e.g. 1% of account per trade – see Position Sizing below). In the backtest, log the stop price and ensure the trade is counted as a loss if that level is hit after entry.
	•	Profit Targets: Use Fibonacci extension levels and prior high for take-profit levels:
	•	TP1: The first target is the 100% retracement (1.0), which is essentially a return to the prior swing high. Often, a strong move will revisit the recent high – at that point, you’ve recovered the entire pullback. Taking partial profit here is prudent. (This level often aligns with a psychological or resistance level where some selling occurs.) In the example earlier, if swing low was $100 and high $120, TP1 = $120.
	•	TP2: The second target is around the 1.272 extension (approximately 127.2% of the swing). This is a common Fibonacci extension where price might pause if the uptrend continues. In our example, that might be around $126.
	•	TP3: The third target is around the 1.618 extension (161.8% of the swing, the “golden ratio” extension). This is an ambitious target for a strong trend continuation – e.g. around $132 in our example. Not every trade will reach 1.618, but it’s the stretch goal to let a winner run if momentum persists.
These targets can be adjusted if technical levels suggest (for instance, if a higher timeframe resistance lies near one of these fib extensions, you might align TP there). In backtesting, you will check how often price hit these levels after entry to gauge reward potential.
	•	Risk-Reward Check: Calculate the R:R ratio from entry to TP1 vs entry to stop. This is critical – we require at least 1:1 and preferably ≥ 2:1 to the first target. If the 50–61.8% entry zone and chosen stop imply, say, a 5% potential loss, then TP1 should be at least 5% away (1:1) or more ideally 10% away (2:1). If you find that due to a tight swing or late entry the TP1 is too close (e.g. only 0.5x the stop distance), skip the trade – the reward does not justify the risk. In practice and in the backtest, this filter improves the expectancy by avoiding low-reward trades. For example, if buying at $108 with stop at $100 (risk $8), but TP1 (prior high) is $112 (reward $4), that’s only 0.5:1 – not acceptable. We would wait either for a deeper pullback (to improve R:R) or pass on that setup. On the other hand, if entry $108, stop $100 (risk $8), TP1 $120 (reward $12), that’s 1.5:1, which is okay, and to TP2 $127 (~2.4:1) which is even better.

Using the above, formulate your trade entry, SL, and TP orders in the backtest context. This means when price hits the entry zone with trend confirmation (next step), you will “enter” a simulated trade, mark the stop level and target levels, and then track subsequent price action to see which order triggers first (stop or TP1/TP2/TP3). The plan should be set such that even if only TP1 is reached, the R:R was reasonable. This discipline aligns with trading best practices – traders often use Fibonacci retracements for entries, place stops just beyond the fib level to avoid normal noise ￼, and target at least the prior high or further ￼, exemplified by the Investopedia scenario where a long entry between 50–61.8% had a stop below 61.8 and a target at the prior high ￼.

5. Position Sizing and Hard Risk Management

With entry and stop determined, calculate position size to risk a fixed percent of capital on the trade (commonly 1% of account per trade in this strategy). This is crucial for realistic backtesting of PnL:
	•	Account Risk Percent: Decide on a risk-per-trade (e.g., 1% of account equity). For backtesting, you can assume a notional account (say $10,000) and risk 1% = $100 per trade. This means if the stop-loss hits, you lose $100 (1%).
	•	Position Size Formula: Compute the position size such that the distance from entry to stop equals that $ risk. For example, if going long at $108 with stop at $100, that’s $8 risk per share/coin. To risk $100, you would take $100 / $8 = 12.5 shares (round down to 12 shares or appropriate lot size). In formula terms for a long:
$$ \text{Quantity} = \frac{\text{Account Risk $} \times \text{Leverage}}{\text{Entry Price} \times (\frac{\text{Entry} - \text{Stop}}{\text{Entry}})} $$
In a simpler form:
$$ \text{Quantity} = \frac{\text{Account Risk $}}{\text{Risk per unit}} $$
where Risk per unit = Entry - Stop (for long). If using leverage in futures, incorporate that (e.g., with 5x leverage, $100 risk can control a $500 position).
	•	Leverage Limits: Ensure the position doesn’t exceed realistic leverage or margin. For instance, if the strategy uses up to 5× leverage, ensure position size * entry price ≤ account_size * leverage. In backtesting, if a computed size is too large, cap it.
	•	Consistency: Keep this risk calculation consistent for every trade. This way, the backtest’s profit/loss outcomes are proportional and not skewed by varying risk. All trades risk ~1% so that a 2:1 R:R win yields ~+2% account, a loss is -1%, etc. This enables a realistic equity curve simulation.
	•	No Oversizing on Adds: If the strategy ever adds to a position on a pullback (as mentioned later for a moderate retracement add-on), make sure the total combined risk still doesn’t exceed your limit (e.g., if adding 50% more at a lower price, recalc stop risk).

This step is more about execution than setup logic. In manual backtesting, you might not explicitly simulate position sizing if you just measure percent moves, but it’s good practice to incorporate it for realistic outcomes. It instills discipline that no single trade (even a perfect setup) should risk ruinous capital.

6. Entry Timing – Confirmation Triggers on 1-Minute Chart

Even when all higher-level conditions are met (15m trend is bullish, price is dipping into the 5m Fib zone), we don’t enter blindly. We wait for confirmation on the 1-minute chart that the pullback is likely ending and momentum is reasserting upward. This reduces false entries (catching a “falling knife”). In backtesting, this can be simulated by requiring certain conditions at or just after the time price enters the entry zone:

Valid Long Entry Triggers (on 1m, within the 0.5–0.618 zone):
	•	A bullish reversal candlestick pattern on 1m, especially a bullish engulfing candle with high volume. For example, a red candle followed immediately by a larger green candle that engulfs it, indicating buyers have overwhelmed sellers. This often signals a short-term trend change from down to up. It’s more reliable if accompanied by a notable increase in volume on the engulfing candle ￼, showing strong participation by buyers. (In a backtest, you can define this objectively: e.g., the 1m candle that closes back above the 0.5 Fib level is green and its volume is higher than the last 5–10 candle average.)
	•	A VWAP reclaims or bounce on 1m within the zone. If during the pullback price dipped below the VWAP, look for price to push back above VWAP and hold there. This suggests the dip is over and price is regaining its volume-average level, a bullish sign. Many day traders use VWAP as intraday support; a reclaim of VWAP from below often indicates buyers reasserting control ￼. In our context, say the 1m VWAP was sliding down during the pullback – once price in the Fib zone rallies and closes above VWAP, that’s a positive trigger.
	•	5m confirmation: In addition to the immediate 1m signal, check that the 5-minute candle is also showing reversal signs. Ideally, the 5m candle corresponding to the entry shows a bottoming tail and closes back above the 5m 9 EMA. If the 5m has been riding below its 9 EMA during the pullback, a close above it indicates momentum shifting upward on the 5m scale as well. In other words, the short-term down move is ending.

For a short trade, the triggers are analogous but inverted:
	•	A bearish engulfing on 1m (a green candle followed by a larger red candle) with volume spike, signaling a bullish bounce is failing.
	•	Price rejects off VWAP from below (if in a downtrend rally it went above VWAP, look for it to fall back under VWAP in the Fib zone).
	•	A 5m candle that closes under the 5m 9 EMA or shows a topping wick.

Only when a valid trigger occurs inside the entry zone do we execute the entry. In backtesting, this means you’d wait until the first 1m bar that satisfies these conditions after price has reached the Fib zone. If price blows through the zone without any bullish signal and keeps falling (for long scenario), then you wouldn’t enter – the trade is void because confirmation never happened. This rule is critical to avoid entries on mere theoretical support. Fibonacci levels alone should be confirmed by actual price action strength returning ￼.

Example: Suppose an altcoin surges from $4 to $5 (swing high), then pulls back. Our Fib zone is $4.50–$4.30. As price dips to $4.40, we monitor the 1m chart: we see a bullish engulfing where a 1m candle goes from $4.38 up to $4.48, engulfing the prior candle, with volume 2x the average. Simultaneously, the 5m closes back above its 9 EMA. This is our cue to enter long around $4.45 (mid of zone) with stop below $4.30. In contrast, if price had sliced down to $4.20 with no green candles in the zone, we would not catch that falling knife.

By incorporating these micro-confirmations in the backtest, you’ll likely improve win rate, as many instances where price free-falls through the level will be filtered out (no entry triggered). Note that sometimes waiting for confirmation might mean entering a few ticks off the absolute low, but that’s a worthy trade-off for higher probability of success.

7. Execution: Simulating Orders and Trade Progression

Once your entry conditions line up (trend bias ✅, price in zone ✅, 1m trigger ✅, 5m structure ✅), it’s time to “execute” the trade in the backtest:
	•	Entry Execution: Assume you place a limit order within the entry zone (or you can simulate a market order once trigger occurs). For simplicity, many backtests will just take the price at the close of the signal candle as the entry price. Record this as the entry price. In reality, you might get a slightly better fill by setting a limit just inside the zone, but using signal close is fine. (If using limit, you could simulate that it gets hit at, say, the midpoint of 0.5–0.618 levels.)
	•	Stop-Loss Order: Immediately upon entry, your stop is active. In backtesting, mark the stop price (e.g., 1% below the 0.618 Fib or below swing low). If the price subsequently touches or goes beyond this level, the trade is counted as stopped out (exit at stop price).
	•	Take-Profit Orders: Set take-profit orders at TP1 and TP2 as outlined (TP1 = swing high, TP2 ≈ 1.272 extension). If your strategy uses partial take-profits, we simulate them via Order Cancels Order (OCO) logic:
	•	Place a sell order for 50% of the position at TP1.
	•	Place another sell for 25–30% at TP2.
	•	The remainder will be managed as a runner (with a dynamic trailing stop aiming for TP3, the 1.618 extension). We don’t set a static TP3 order but will exit via trailing stop or if TP3 is hit, whichever comes first.
For backtest simplicity, you can either code partial exits or at least note the high price achieved to see if TP1, TP2, TP3 would have been reached. If partial exits are complex to simulate, another approach is to record the outcome as if a full exit at TP1 or TP2 etc., but ideally we track partial for more accuracy.
	•	Outcome Tracking: As you progress through historical data, you will track the trade after entry. Two main outcomes are possible:
	1.	Stop hit before any target: The trade is a full loss (-1R, which is -1% account in our sizing). Log the loss and proceed.
	2.	Target(s) hit: When price hits TP1, simulate that we sell half the position there. Mark that partial profit (which secures +R (risk units) of profit). Adjust the stop-loss to breakeven (we’ll detail this in management step, but essentially now worst-case the remaining half won’t lose). If price continues, and hits TP2, sell another quarter of original position. Now 75% of the trade is closed in profit. The remaining 25% we let run toward TP3 with a trailing stop. If price hits TP3, that final portion is taken, otherwise a trailing stop will likely take it out when trend eventually reverses.
Ensure your backtest captures these incremental exits. For instance, you might maintain variables for position remaining and exit prices, calculating total P&L as sum of each portion’s profit.
	•	Slippage/Fees: Depending on how precise you want the backtest, you might subtract a small slippage or trading fee. For example, if market orders are implied, maybe knock 0.1% off each exit for fees. This can usually be ignored for longer-term moves as it’s minor, but for completeness you might include it.

By setting up the entries and OCO orders in the backtest, you mirror how a real trade would be managed from the outset – with a predetermined stop and take-profit plan. This prevents retrospective bias (e.g., endlessly holding a winner or not defining a stop). The trade now runs its course in your historical data – next we manage it as it progresses.

8. Trade Management and Exit Rules

Once in a trade, active management can significantly improve outcomes by mitigating risk and locking in profits as the market moves. The strategy employs several management rules which should be applied in backtesting as the price evolves after entry:
	•	Stop to Breakeven: When price moves in your favor by +1× your initial risk (i.e., if it goes past TP1 or roughly halfway to TP1), move the stop-loss up to the entry price (breakeven). In practice, this often coincides with TP1 being hit: after taking 50% profit at TP1, you don’t want the remaining position to turn into a loss, so you adjust the stop on the rest to break even. This creates a “risk-free” trade on the remainder – worst case, the second half will stop out at no loss ￼. (Some traders even trail the stop to slightly above entry to cover fees, but breakeven is fine.) Note: Some argue moving stops too early can cut winners short ￼ ￼, which is why we wait for at least 1R move. Backtesting will show if this improves results; it usually does by eliminating full losses after partial profits.
	•	Partial Profit at TP1: As per plan, when TP1 is reached, take 50% profit off the table. Record this exit in the backtest (realizing, say, +2R gain if TP1 was at +4% and stop was -2%, etc.). Additionally, after TP1:
	•	Set Stop = Breakeven (as mentioned).
	•	This locks a net positive outcome (you’ve banked half the profit, and the rest won’t lose money beyond entry).
	•	Partial Profit at TP2: When/if TP2 is hit, take another 25% (or up to 35%) off the position. Now a total of 75%+ of the trade is profit realized. At this stage, implement a trailing stop on the final piece to aim for further gains:
	•	After TP2, you can tighten the stop further – perhaps to protect a portion of the TP2 gain. For example, you might move the stop on the last 25% up to just below TP1 level or some logical level, to ensure you lock in at least half the gains on that runner.
	•	Alternatively, trail using an indicator: e.g., you can use 5m or 15m EMA as a guide – perhaps if price has been riding above the 5m 9 EMA, you could decide that a close below the 5m 9 EMA signals to exit the remainder. The strategy actually outlines a systematic trailing method using EMAs which we describe next.
	•	Trailing Stop for Runner: For the remaining 25% position (after TP2), the goal is to let it run as far as possible (possibly to TP3 1.618 extension or beyond) with a trailing stop that moves up as price moves up. The strategy sets trailing stops based on profit milestones:
	•	When open profit is < +25% (ROE or price gain relative to entry), use a relatively tight trail: e.g., trail just below the last 5m swing low by ~0.3–0.5%. This means if a minor pullback happens, you give a little room (0.3-0.5%) below the last local low, but not much – you’re not very far in profit yet, so you don’t want it turning negative.
	•	Once profit is 25–60%, loosen the trail a bit: perhaps trail under the 5m 9 EMA by ~0.5%. The idea is as profit grows, you can allow a slightly larger retracement without exiting, because the trend may breathe more. But staying just under the 5m EMA keeps you close behind the short-term trend.
	•	If profit > 60%, you’re in a big winner. At that point, switch to a wider perspective: trail under the 15m 9 EMA by ~1%. This gives the trade ample room to run on the larger trend, while still protecting a good chunk of profit. Essentially, as long as price keeps closing above the 15m EMA (minus 1%), you ride the trend. Once it closes below, momentum is likely shifting, so you lock out.
In backtest implementation, you can approximate these rules. For instance, you can check at each new 5m/15m candle if the conditions are met to move the stop. It’s a bit complex, but you can simulate trailing by updating the stop price upward whenever a new higher low forms on the 5m chart above our current stop or when an EMA catch-up condition hits. The key is trailing only moves upward, never down. You may simply record the exit of the final 25% when either a reversal triggers the trailing stop or when a specific price (like TP3) is reached.
	•	Full Exit Signals: Regardless of targets, there are certain conditions where we’ll exit the trade entirely early:
	•	If price action breaks the trend structure decisively. For example, price closes below the 15m 9 EMA and also below your trailing stop – essentially a significant short-term trend break. This often coincides with hitting your stop if you trailed appropriately. In backtest, this is covered by how we move the stop.
	•	If two consecutive lower highs form on the 5m chart in a long trade (or higher lows in a short trade), it’s a sign the trend run is over (double top or descending trend starting). You might choose to exit the remainder at that point. This might be subjective to code, but you can look for when a rally fails to make a new high twice.
	•	If an external factor occurs like a sudden news spike or massive volume dump that breaks structure, your stop would likely be hit anyway. (In real trading you’d manually close; in backtest we assume price triggers stops in such cases.)
	•	If funding rates spike above 0.30% during the trade and price stalls, that could be a sign of euphoria – you might take profits early. In backtesting, you could incorporate funding data if available historically, but it’s advanced. Generally, you can skip this unless you have time-synced funding info.
The order of priority is usually: stop-loss (or trailing stop) will eventually take you out if the trend reverses. If a target is hit first, you take profit. If neither stop nor target hit for a while, trailing rules may incrementally move the stop up and eventually you’ll get taken out when momentum wanes. Always ensure no trade is left open beyond its logical exit. For backtest bookkeeping, the trade should be marked closed either at stop or final target or some exit condition, so P&L is realized.

By applying these management rules, the backtest will more accurately reflect a dynamic trading approach (as opposed to a simple one-shot entry/exit). This often improves overall results: losers are cut short (stop or BE), winners sometimes run big, and partial profits secure gains. It’s important in backtesting to simulate moving the stop to breakeven after TP1, because this dramatically affects the distribution of losses vs. breakevens vs. wins (many trades will end up break-even instead of full losses, improving the win:loss ratio, though some winners might also stop at BE if only TP1 hit then reversed).

Example of management in action: Using the earlier example trade (entry $4.45, stop $4.30): Price hits TP1 $5.00 → sell half. Stop was $4.30, move it up to $4.45 (entry). Price then hits TP2 $5.33 → sell another 25%. Move trailing stop to maybe $5.00 (lock that profit on remaining). Price runs to $5.90 but then closes below 15m EMA at $5.75 → trigger trailing stop exit for final 25% at $5.70. Overall, the trade netted: +12% on half, +19.7% on a quarter, +28% on a quarter. The strategy thus captured a large move while progressively reducing risk. Backtest statistics would count that as a win with an average exit around +17% gain (weighted).

9. Handling Retracements: Shallow vs. Deep Pullbacks

Not all pullbacks are equal. In live trading, one might adjust if the retracement is shallow or deeper than expected, including adding to a position or bailing out early. In a backtest, you can incorporate simplified rules to emulate this nuance:
	•	Type A: Shallow Pullback – Price only retraces to around the 38.2% Fib or barely tags the 0.5 level before resuming upward, often staying above the 5m 9 EMA. This indicates extremely strong momentum (buyers jumped in early). In such cases, if you strictly waited for 50–61.8%, you might not have gotten a fill. If your backtesting allows, you might consider that a miss – or you could adapt an aggressive entry rule: e.g., if a clear bottom forms at 38% Fib with a strong 1m reversal, one could enter with a smaller size. But to keep rules consistent, it’s okay if some shallow pullbacks are missed trades. If you did enter (say at 38% retracement) because it’s still within criteria, then manage as usual. No add needed, just hold and trail because the strength is high. Often shallow pullbacks never threaten the stop (which would be far below), so those will be big wins in backtests.
	•	Type B: Moderate Pullback – Price retraces into the 0.5–0.618 zone (our ideal entry), perhaps even wicks slightly below 0.618, but quickly recovers. Volume often rebounds as it pushes off the zone. This is the textbook scenario – you enter in the zone. If the bounce is confirmed and the trend resumes, great. If the bounce is a bit slow or choppy, some traders might add to the position on a successful retest – e.g., if price double-bottoms near 0.618 and then starts higher, one might add another partial position (provided total risk stays reasonable, say you add 50% of initial size). In backtesting, adding is tricky to simulate, but you can note that these scenarios would have improved entry basis. For simplicity, you might skip simulating adds unless you’re advanced. Instead, ensure the initial entry is sized such that you’re comfortable without adding. If you do simulate adding: treat it like a second entry signal and recalc combined cost and adjust stop if needed (usually still same stop).
	•	Type C: Deep Pullback or Breakdown – Price retraces beyond the 61.8% significantly, perhaps to 78.6% or more, and especially if it closes below the 15m 21 EMA (or 20 EMA) and below prior support structure. This often means the uptrend is in trouble (at least short-term). Our plan in such a case: exit and stand aside. If you hadn’t entered yet, you obviously wouldn’t at this point. If you did enter around 0.5–0.618, this deep drop would likely hit your stop-loss anyway (since stop is just under 0.618 or structure). So in backtest, these are straightforward losing trades. If somehow price hovers and doesn’t hit stop but closes deep below EMAs, you might choose to manually cut it around the stop level instead of hoping. Essentially, treat a close well below 0.618 as a failure – mark the trade as stopped (even if not yet by tick) to be consistent. You can also set a rule: if no bounce occurs and candle closes below 0.65 or 0.70 retracement, assume stop-out (to avoid long agony).

After a deep pullback and exit, re-entry protocol is possible: Wait for the market to reclaim key levels (like the 15m 9 EMA and the lost support) and only then consider a new long, essentially treating it as a new trade. For backtesting, that would mean later if price rallies back above the swing point with volume, you might start the sequence again (with updated swing levels).

In summary, when analyzing backtest results, categorize your trades by these types. You may observe Type A shallow pullbacks rarely triggered an entry (or if they did, never came near stop and yielded high R). Type B should constitute most trades. Type C will be your losing trades. Ensuring you exit quickly on Type C and not “adding” into them is crucial for risk control.

10. (Optional) Order Book & Volume Profile Considerations

This aspect is more nuanced and often not available in backtesting without tick data, so you might skip in automation. But conceptually, be aware:
	•	Bid Clusters at Fib Zone: If you have order book data, large bid walls sitting around the 0.5–0.618 levels indicate strong demand there. In live trading, seeing that would give confidence to lean into the long entry. In a backtest, you might note lower wicks on candles (implying buying absorption) as a proxy. If a 5m candle in the zone has a long tail and decent volume, that suggests bids absorbed selling – consistent with OB support.
	•	Ask Clusters near Targets: If big ask orders are seen near the previous high or 1.272 extension, it could mean many traders plan to take profit there. This sometimes causes price to stall just before TP levels. In backtest, you might see price just barely reaches 0.98 of the prior high and then pulls back. It can be worth adjusting your TP slightly below major round numbers or known resistances to account for this. (E.g., if prior high was $100, maybe set TP1 at $99.5).
	•	Vanishing Walls: If a large bid that was propping the price suddenly disappears from the order book, the price might dip quickly (a bearish sign to tighten stops). Conversely, if major ask walls get pulled, it can precede a rapid breakout (stay in trade). These are hard to model historically, but you can indirectly infer – e.g., a sudden fast drop might indicate bids pulled (stop-hunt), whereas a strong expansion candle might indicate asks lifted.
	•	Volume Profile Levels: High volume nodes on a volume profile can act as support/resistance. Often, 0.5–0.618 zones coincide with a volume shelf from earlier consolidation. If backtesting with volume profile, consider if entry zone had such support – it often aligns with better outcomes.

In summary, while order book signals are not explicitly backtested here, understanding them can qualitatively explain some outcomes. For instance, if your backtest log shows a trade stopped out by a quick wick then immediately reversing back up, that might have been a stop-hunt – something an order book would have hinted (momentary liquidity vacuum). In practice you might re-enter after such events (with the re-entry rules), but for backtest you likely counted it as a loss or break-even. That’s acceptable as a conservative measure.

11. Symmetric Short Setup Guidelines

All the above strategy rules can be mirrored for short trades during bearish trends. Ensure your backtesting logic accounts for short entries when conditions align:
	•	Scanner: The pre-filter for shorts could include a negative 24h Δ% threshold (e.g., -25% or more, indicating a strong downward move), volume ≥$10M, funding ≤ -0.25% (to avoid overcrowded shorts), etc. This was not explicitly stated, but symmetry implies we look for crashing coins with high volume and overly negative funding (sign of potential squeeze).
	•	Trend Bias (15m): 9 EMA < 20 EMA and price below VWAP to consider shorts (downtrend confirmation).
	•	Swing & Fibonacci: Identify the recent swing high down to swing low on 5m. Draw retracements of that drop (price will be bouncing upward). Mark the 38.2%, 50%, 61.8% retracement levels of the decline. The 0.5–0.618 zone is now a short entry zone (a “sweet spot” to sell into a bounce). Essentially it’s the mirror image: the bounce is a temporary relief rally in an overall downtrend.
	•	Entry Trigger (1m): Look for bearish confirmation in the zone. E.g., a 1m bearish engulfing pattern ￼ with high volume (buyers failing and sellers resuming control), or a failure to overcome VWAP (price may poke above VWAP and then fall back below – a common short signal). Also a 5m candle showing a long upper wick or closing below its 9 EMA helps.
	•	Entry & Stop: Enter within 50–61.8% retracement of the drop. Place stop-loss just above the 61.8% level or above the swing high (with a small buffer). You want your stop a bit above that resistance zone where, if broken, the downtrend may be in question.
	•	Targets for Shorts:
	•	TP1 = 0% retracement, i.e., the prior swing low (take 50% profit as price revisits the low of the move). This is analogous to TP1 at prior high for longs.
	•	TP2 = -27.2% extension (sometimes written 0.272 in Fibonacci tools for below 0). This is the 1.272 extension on the downside – a common target in breakdowns.
	•	TP3 = -61.8% extension (1.618 extension below, a stretch target if the plunge continues).
	•	Management: As with longs, take partials at TP1 and TP2. Move stop to breakeven after TP1 (so if the bounce returns, you don’t lose on remaining). Trail the stop down on the final portion using analogous rules (e.g., trail above 5m EMA for moderate profit, above 15m EMA for large profit, etc.). Exit fully if price closes above the 15m 9 EMA or makes two higher lows on 5m (sign downtrend momentum is over).
	•	Re-entry: If stopped out or exited but the downtrend resumes (e.g., after a deeper pullback or second bounce), you can re-enter on the next fib retracement or break of structure with confirmation. Backtest can allow multiple short entries over a long downtrend, each time the pattern appears.

Example: The chart above of 3M (MMM) in a downtrend shows a bounce retracing about 50% of the prior decline, reaching the Fib resistance zone (blue lines) before the downtrend continued. A trader could short in that zone with a stop just above 61.8%. The subsequent drop took price to new lows (green decline after the bounce). This illustrates the short setup: during backtesting, whenever an asset is in a confirmed downtrend and rallies up to the 50–62% retracement of its drop, you look for a bearish signal to initiate a short. Profit is then taken as it falls back to or below the previous swing low. All risk management (position sizing, moving stop to entry after profit, etc.) should be applied similarly for short trades.

By including short trades in your backtest, you’ll see performance in both bull and bear market conditions. Often, strong momentum losers (big 24h drops) can yield sharp bounces to short into. Ensure the rules are mirrored and you might find the win rates and R:R behave similarly inverted.

12. Backtesting Implementation Tips and Summary

To systematically backtest this strategy, follow a structured loop for each asset and each timeframe step:
	1.	Load Data: You’ll need historical OHLCV data for 15m, 5m, and 1m intervals (ideally synchronized). If that’s not possible, a workaround is to use 1m data for everything and aggregate for signals (more complex). Ensure you have at least a year+ of data to cover various conditions.
	2.	Scan Daily or Weekly: Identify each period where a coin meets Pre-Filter criteria (e.g., each day check if the previous 24h % change, volume, funding meet thresholds). Mark those as potential trade days for that asset.
	3.	For each such period, iterate forward on 15m candles: Check the Trend Bias condition on each 15m candle (9 EMA vs 20 EMA, price vs VWAP). When a candle satisfies bias=LONG or bias=SHORT, then move to the next step for trade setup.
	4.	Identify Swing on 5m: Around the time bias turns positive, or after a large move, use the 5m data to mark a swing high/low. You might do this by looking for a notable high followed by at least one lower high (for uptrend swing high) or vice versa. Calculate Fib levels for that swing.
	5.	Wait for Retracement: Monitor the 5m/1m price to see when it enters the 0.5–0.618 retracement zone. Once price is in that zone (or just approaching it from above for longs), start looking at 1m candles for triggers.
	6.	Trigger and Entry: The moment you detect a valid trigger on 1m (engulfing etc.), record an entry at that price. Set stop and targets as defined. If price instead goes below the zone without trigger and hits what would be the stop level, abort the attempt (no trade, or count it as not triggered).
	7.	Simulate Trade Progress: Advance through 1m candles:
	•	If price hits stop, mark trade as loss, stop managing it.
	•	If price hits TP1, mark partial profit, reduce position, move stop to entry.
	•	If price hits TP2, take another partial, tighten trailing stop.
	•	Continue until stop-out or final target. Use 5m/15m closes to adjust trailing stops as per rules.
	8.	Record the outcome: log R-multiple gained or lost, trade duration, etc. Then continue scanning for next setup. Only one trade per clear setup swing is typical; you might avoid entering a second trade until trend makes a new impulse and pullback.
	9.	Re-entry logic: If stopped at BE and then price goes on to move favorably without you, you might consider re-entering on a secondary signal (though rules didn’t detail this much aside from mention after deep pullback reclaims). To keep things simple, one attempt per swing is okay. But you could allow one re-entry if the conditions reset (e.g., price regains 15m EMA after a deep pullback).
	10.	Repeat for all instances and all assets.

While coding this is involved, the above is the logical flow. After running the backtest, compile performance metrics: win rate, average reward vs risk, maximum drawdown, etc.

Summary (TL;DR) Decision Flow:
	•	Scan for high-momentum, liquid coins ✅ (24h +25-90%, volume $10M+, low funding, etc.).
	•	Trend Check (15m) ✅ – Trade only in direction of trend (9EMA vs 20EMA, VWAP alignment).
	•	Mark Swing & Fib (5m) ✅ – Identify the impulse move and key Fib retracement levels (focus 50–61.8%). Formulate entry, stop, target levels. Ensure R:R ≥ 1:1 (ideally 2:1) to TP1, otherwise skip.
	•	Wait for Entry Zone & Trigger (1m & 5m) ✅ – Let price come to you in the zone. Enter only if a confirming reversal signal occurs (e.g., bullish engulfing with volume for long) and structure indicates bounce. Place entry and OCO (stop-loss and take-profit orders).
	•	Manage the Trade – If trade triggers:
	•	Protect at 1R: move stop to breakeven when feasible.
	•	Take partial profits at TP1 (50%) and TP2 (~25%).
	•	Trail the rest according to trend strength (use EMA or structure to exit on weakness).
	•	Exit – Either stopped out (small loss or BE) or take final profits on trend reversal.
	•	Iterate – Continue scanning for next opportunity or, if trend continues, possibly stack another trade on a new swing later.

By following these backtesting instructions, you’ll effectively simulate the strategy’s real-world logic. The result will be a comprehensive view of how this Momentum-Fibonacci playbook performs historically, capturing its high-probability entries, risk control, and profit potential. Remember to analyze both the statistical outcomes and individual trades to gain insight (e.g., many losses might be small stop-outs or breakevens, while winners cover them with larger gains). This granular, rule-based backtest will validate if the unified momentum + Fibonacci strategy indeed yields an edge in the markets, and where it might be refined further for even better results. Good luck with your backtesting! ￼ ￼